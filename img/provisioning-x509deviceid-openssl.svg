<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="250px" preserveAspectRatio="none" style="width:571px;height:250px;" version="1.1" viewBox="0 0 571 250" width="571px" zoomAndPan="magnify"><defs><filter height="300%" id="f8qeoxwnrq261" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="253" x="159.75" y="26.6992">Internals of the TLS client auth</text><rect fill="#FFFFFF" filter="url(#f8qeoxwnrq261)" height="87.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="391" y="104.7344"/><rect fill="#FFFFFF" filter="url(#f8qeoxwnrq261)" height="29.2344" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542" y="133.9688"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="43" x2="43" y1="73.5" y2="210.4375"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="396" x2="396" y1="73.5" y2="210.4375"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="546.5" x2="546.5" y1="73.5" y2="210.4375"/><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="8" y="38.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="15" y="58.082">openssl</text><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="8" y="209.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="15" y="229.4258">openssl</text><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="327" y="38.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="334" y="58.082">openssl-engine-ks</text><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="327" y="209.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="334" y="229.4258">openssl-engine-ks</text><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="31" x="529.5" y="38.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="17" x="536.5" y="58.082">KS</text><rect fill="#FEFECE" filter="url(#f8qeoxwnrq261)" height="30.4063" style="stroke: #A80036; stroke-width: 1.5;" width="31" x="529.5" y="209.4375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="17" x="536.5" y="229.4258">KS</text><rect fill="#FFFFFF" filter="url(#f8qeoxwnrq261)" height="87.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="391" y="104.7344"/><rect fill="#FFFFFF" filter="url(#f8qeoxwnrq261)" height="29.2344" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="542" y="133.9688"/><polygon fill="#A80036" points="379,100.7344,389,104.7344,379,108.7344,383,104.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="43" x2="385" y1="104.7344" y2="104.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="50" y="99.5605">openssl::EVP_PKEY_sign(privkey openssl::EVP_PKEY, ...)</text><polygon fill="#A80036" points="530,129.9688,540,133.9688,530,137.9688,534,133.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="401" x2="536" y1="133.9688" y2="133.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="408" y="128.7949">sign("key handle", ...)</text><polygon fill="#A80036" points="412,159.2031,402,163.2031,412,167.2031,408,163.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="406" x2="546" y1="163.2031" y2="163.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="418" y="158.0293">OK(signature)</text><polygon fill="#A80036" points="54,188.4375,44,192.4375,54,196.4375,50,192.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="48" x2="395" y1="192.4375" y2="192.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="60" y="187.2637">OK(signature)</text><!--MD5=[3675910c88c96ce67ee6edc69423668b]
@startuml

title Internals of the TLS client auth

participant openssl
participant "openssl-engine-ks"
participant KS

openssl -> "openssl-engine-ks" ++: openssl::EVP_PKEY_sign(privkey openssl::EVP_PKEY, ...)
"openssl-engine-ks" -> KS ++: sign("key handle", ...)
return OK(signature)
return OK(signature)

@enduml

PlantUML version 1.2020.06(Sun Apr 05 05:38:32 PDT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+10-suse-3.1-x8664
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>